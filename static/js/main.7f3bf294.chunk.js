(this["webpackJsonpsimple-chat"]=this["webpackJsonpsimple-chat"]||[]).push([[0],{104:function(e,t,n){},141:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),i=n(9),a=n.n(i),r=(n(104),n(63)),o=n.n(r),l=n(22),u=n(67),j=n(31),m=n(87),b={socket:null,createChannel:function(){this.socket=Object(m.io)("https://simple-chat-back.herokuapp.com",{transports:["websocket","polling","flashsocket"]})},destroyChannel:function(){var e;null===(e=this.socket)||void 0===e||e.close(),this.socket=null},subscribe:function(e,t,n){var s,c,i;null===(s=this.socket)||void 0===s||s.on("messages-showed",e),null===(c=this.socket)||void 0===c||c.on("new-message-sent",t),null===(i=this.socket)||void 0===i||i.on("writing-message",n)},sendClientName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-sent-name",e)},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-sent-message",e)},writingMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-writing-message")}},d={messages:[],writingUsers:[]},h=n(176),f=n(173),O=n(185),g=Object(f.a)((function(){return Object(O.a)({root:{flexGrow:1}})})),p=n(178),x=n(179),v=n(4),E=c.a.memo((function(){var e=g();return Object(v.jsx)("div",{className:e.root,children:Object(v.jsx)(h.a,{position:"static",children:Object(v.jsx)(p.a,{variant:"dense",children:Object(v.jsx)(x.a,{variant:"h6",color:"inherit",children:"Simple chat"})})})})})),N=n(11),S=Object(f.a)({root:{width:600,height:200,display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"center"},title:{fontSize:24,fontWeight:600}}),C=n(180),k=n(181),w=n(182),T=n(184),y=c.a.memo((function(){var e=S(),t=Object(N.f)();return Object(v.jsxs)(C.a,{className:e.root,children:[Object(v.jsx)(k.a,{children:Object(v.jsx)(x.a,{className:e.title,color:"textSecondary",gutterBottom:!0,children:"Would you like entering your nickname?"})}),Object(v.jsxs)(w.a,{children:[Object(v.jsx)(T.a,{variant:"contained",color:"primary",size:"medium",onClick:function(){t.push(W.ENTER_USER_NAME)},children:"Yes"}),Object(v.jsx)(T.a,{variant:"contained",color:"secondary",size:"medium",onClick:function(){t.push(W.CHAT)},children:"No"})]})]})})),A=n(30),_=n(183),R=Object(f.a)({root:{width:600,height:200,display:"flex",justifyContent:"center",alignItems:"center"},input:{width:200,marginRight:15}}),M=c.a.memo((function(){var e=Object(s.useState)(""),t=Object(A.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(!1),a=Object(A.a)(i,2),r=a[0],o=a[1],u=Object(l.b)(),j=R(),m=Object(N.f)(),d=r?"Please enter your nick name":"";return Object(v.jsxs)(C.a,{className:j.root,children:[Object(v.jsx)(_.a,{className:j.input,value:n,id:"nick name",label:"nick name",color:r?"secondary":"primary",autoComplete:"off",onChange:function(e){c(e.currentTarget.value),o(!1)},helperText:d,onBlur:function(){return o(!1)}}),Object(v.jsx)(T.a,{disabled:r,variant:"contained",color:"primary",onClick:function(){""!==n.trim()?(u(function(e){return function(t){b.sendClientName(e)}}(n)),m.push(W.CHAT),c("")):o(!0)},size:"small",children:"Send Name"})]})})),H=c.a.memo((function(e){var t=e.message,n=e.className;return Object(v.jsxs)("div",{className:n,children:[Object(v.jsxs)("b",{children:[t.user.name,": "]})," ",Object(v.jsx)("span",{children:t.message})]})})),U=c.a.memo((function(e){var t=e.user,n=e.className;return Object(v.jsxs)("div",{className:n,children:[Object(v.jsxs)("b",{children:[t.name,": "]})," ",Object(v.jsx)("span",{children:"..."})]})})),I=Object(f.a)({root:{display:"flex",flexDirection:"column",padding:10,minHeight:550,width:350},chatBlock:{overflowY:"scroll",height:520,minWidth:"93%"},message:{backgroundColor:"#e0e0e0",padding:10,borderRadius:7,"&:nth-child(2n)":{backgroundColor:"#eeeeee"}},formBlock:{display:"flex",justifyContent:"space-between",marginTop:10,position:"relative"},input:{width:"80%"},button:{position:"absolute",right:0}}),B=c.a.memo((function(){var e=Object(s.useState)(""),t=Object(A.a)(e,2),n=t[0],c=t[1],i=Object(l.c)((function(e){return e.chat.messages})),a=Object(l.c)((function(e){return e.chat.writingUsers})),r=Object(l.b)(),o=I(),u=Object(s.useState)(!0),j=Object(A.a)(u,2),m=j[0],d=j[1],h=Object(s.useState)(0),f=Object(A.a)(h,2),O=f[0],g=f[1],p=Object(s.useRef)(null);Object(s.useEffect)((function(){m&&x()}),[m,i]);var x=function(){var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return Object(v.jsxs)(C.a,{className:o.root,children:[Object(v.jsxs)(k.a,{onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight,s=Math.abs(n-t.scrollTop);t.scrollTop>O&&s<10?d(!0):d(!1),g(t.scrollTop)},className:o.chatBlock,children:[i.map((function(e){return Object(v.jsx)(H,{message:e,className:o.message},e.id)})),a.map((function(e){return Object(v.jsx)(U,{user:e,className:o.message},e.user_id)})),Object(v.jsx)("div",{ref:p})]}),Object(v.jsxs)("div",{className:o.formBlock,children:[Object(v.jsx)(_.a,{className:o.input,id:"message",multiline:!0,maxRows:3,value:n,onChange:function(e){c(e.target.value)},onKeyPress:function(){r((function(e){b.writingMessage()}))}}),Object(v.jsx)(T.a,{variant:"contained",color:"primary",size:"small",className:o.button,onClick:function(){var e;""!==n.trim()&&(r((e=n,function(t){b.sendMessage(e)})),c(""))},children:"Send"})]})]})})),W={USER_NAME:"/",ENTER_USER_NAME:"/enter_user_name",CHAT:"/chat"},G=c.a.memo((function(){return Object(v.jsxs)(N.c,{children:[Object(v.jsx)(N.a,{exact:!0,path:W.USER_NAME,render:function(){return Object(v.jsx)(y,{})}}),Object(v.jsx)(N.a,{path:W.ENTER_USER_NAME,render:function(){return Object(v.jsx)(M,{})}}),Object(v.jsx)(N.a,{path:W.CHAT,render:function(){return Object(v.jsx)(B,{})}})]})})),z=c.a.memo((function(){var e=Object(l.b)();return Object(s.useEffect)((function(){return e((function(e){b.createChannel(),b.subscribe((function(t){e(function(e){return{type:"CHAT/MESSAGES-RECEIVED",messages:e}}(t))}),(function(t){e(function(e){return{type:"CHAT/NEW-MESSAGES-SENT",message:e}}(t))}),(function(t){e(function(e){return{type:"CHAT/WRITING-USER",user:e}}(t))}))})),function(){e((function(e){b.destroyChannel()}))}}),[]),Object(v.jsxs)("div",{className:o.a.App,children:[Object(v.jsx)(E,{}),Object(v.jsx)("div",{className:o.a.main,children:Object(v.jsx)(G,{})})]})})),D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,187)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),i(e),a(e)}))},F=n(54),P=n(92),V=Object(F.b)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHAT/MESSAGES-RECEIVED":return Object(j.a)(Object(j.a)({},e),{},{messages:t.messages});case"CHAT/NEW-MESSAGES-SENT":return Object(j.a)(Object(j.a)({},e),{},{messages:[].concat(Object(u.a)(e.messages),[t.message]),writingUsers:e.writingUsers.filter((function(e){return e.user_id!==t.message.user.user_id}))});case"CHAT/WRITING-USER":return Object(j.a)(Object(j.a)({},e),{},{writingUsers:[].concat(Object(u.a)(e.writingUsers.filter((function(e){return e.user_id!==t.user.user_id}))),[t.user])});default:return e}}}),J=Object(F.c)(V,Object(F.a)(P.a)),L=n(42);a.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(L.a,{children:Object(v.jsx)(l.a,{store:J,children:Object(v.jsx)(z,{})})})}),document.getElementById("root")),D()},63:function(e,t,n){e.exports={App:"App_App__v49mH",main:"App_main__2WR7A"}}},[[141,1,2]]]);
//# sourceMappingURL=main.7f3bf294.chunk.js.map